{% extends 'base.html' %}
{% block content %}
<h1>File operations</h1>


<div class="flo-btn-group">
  <a class="flo-btn" id="flo-back-btn" href="{{back_url}}" title="Go back">
    <i class="bi bi-skip-backward-fill"></i>
  </a>
</div>

{{ render_form(form) }}


<script>
  document.addEventListener("DOMContentLoaded", function () {
    const opSelect = document.getElementById("operation");
    const templateList = document.getElementById("template").parentElement;
    const destWrapper = document.getElementById("destination").parentElement;
    const files = document.getElementById("files").parentElement;
    const obfuscate = document.getElementById("obfuscate").parentElement;
    
    const formEl = document.querySelector("form");

    function toggleVisibility() {
      templateList.style.display = (opSelect.value === "new") ? "block" : "none";
      destWrapper.style.display = (opSelect.value === "copy" || opSelect.value === "move") ? "block" : "none";
      files.style.display = (opSelect.value === "upload") ? "block" : "none";
      obfuscate.style.display = (opSelect.value === "obfuscate") ? "block" : "none";

    }


    toggleVisibility();
    opSelect.addEventListener("change", toggleVisibility);

    // on delete -> submit
    formEl.addEventListener("submit", function (e) {
      if (opSelect.value === "delete") {
        const confirmed = confirm("Are you sure you want to delete this file/folder?");
        if (!confirmed) {
          e.preventDefault(); // cancel submit
        }
      }
    });
  });
</script>
{% endblock %}